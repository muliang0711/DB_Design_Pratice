COLUMN shopType FORMAT A15 HEADING 'Shop Type'
COLUMN totalShops FORMAT 999 HEADING 'Total'
COLUMN shopNumbers FORMAT A50 HEADING 'Shop Numbers'

CREATE OR REPLACE VIEW vw_ShopCategories AS
SELECT 
    RPAD(NVL(shopType, 'Unknown'), 15) AS shopType,
    RPAD(COUNT(*), 3) AS totalShops,
    LISTAGG(shopNo, ', ') WITHIN GROUP (ORDER BY shopNo) AS shopNumbers
FROM shop
GROUP BY shopType;
