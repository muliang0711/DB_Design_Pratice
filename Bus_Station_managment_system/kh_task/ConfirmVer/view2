COLUMN "Rental Month" HEADING 'Month'
COLUMN "Total Collections" HEADING 'Collections'
COLUMN "Total Amount" FORMAT 999,999.99 HEADING 'Total (RM)'
COLUMN "Total Paid" FORMAT 999,999.99 HEADING 'Paid (RM)'
COLUMN "Total Unpaid" FORMAT 999,999.99 HEADING 'Unpaid (RM)'

CREATE OR REPLACE VIEW vw_RentalSummary AS
SELECT 
    rentalMonth,
    COUNT(*) AS totalCollections,
    SUM(rentalAmount) AS totalAmount,
    SUM(CASE WHEN status = 'paid' THEN rentalAmount ELSE 0 END) AS totalPaid,
    SUM(CASE WHEN status <> 'paid' THEN rentalAmount ELSE 0 END) AS totalUnpaid
FROM rentalCollection
GROUP BY rentalMonth
ORDER BY rentalMonth;
