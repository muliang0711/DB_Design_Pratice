CREATE OR REPLACE TRIGGER TKT_BU_CUST_TO_PAY
BEFORE UPDATE OF customerId ON ticket
FOR EACH ROW
WHEN (OLD.customerId IS NULL AND NEW.customerId IS NOT NULL)
BEGIN
  -- set status directly
  :NEW.status    := 'been_bought';
  :NEW.updatedAt := SYSTIMESTAMP;

  -- still call procedure, but procedure should NOT update ticket
  GEN_PAYMENT_FOR_TICKET(:NEW.ticketId, :NEW.customerId, :NEW.price);
END;
/
SHOW ERRORS TRIGGER TKT_BU_CUST_TO_PAY;